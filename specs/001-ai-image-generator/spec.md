# Feature Specification: AI 이미지 생성 및 편집 웹 서비스

**Feature Branch**: `001-ai-image-generator`
**Created**: 2026-01-13
**Status**: Draft
**Input**: User description: "AI 기반 이미지 생성/편집 웹 서비스 - Text-to-Image, Image-to-Image, 이미지 합성 기능"

## Clarifications

### Session 2026-01-13

- Q: 초기 버전에서 사용자 인증 방식은? → A: 간단한 이메일/비밀번호 로그인 (회원가입 필요)
- Q: 생성된 이미지 서버 보관 기간은? → A: 2일 (48시간 후 자동 삭제)
- Q: 사용자별 일일 이미지 생성 제한은? → A: 일일 3회

## User Scenarios & Testing *(mandatory)*

### User Story 1 - 프롬프트로 이미지 생성 (Priority: P1)

사용자가 텍스트 프롬프트만 입력하여 원하는 이미지를 생성한다. 이것이 서비스의 가장 기본적이고 핵심적인 기능이다.

**Why this priority**: 대부분의 사용자가 가장 먼저 시도하는 기능이며, 다른 모든 기능의 기반이 됨. 프롬프트 기반 생성이 작동해야 Image-to-Image나 합성 기능도 의미가 있음.

**Independent Test**: 프롬프트 입력창에 텍스트를 입력하고 생성 버튼을 클릭하면 이미지가 생성되어 화면에 표시되고 다운로드할 수 있음

**Acceptance Scenarios**:

1. **Given** 사용자가 메인 페이지에 있을 때, **When** 프롬프트를 입력하고 "생성" 버튼을 클릭하면, **Then** 작업 상태가 표시되고 완료 시 생성된 이미지가 화면에 나타난다
2. **Given** 이미지 생성이 진행 중일 때, **When** 사용자가 작업 상태를 확인하면, **Then** 대기/진행/완료/실패 중 현재 상태가 표시된다
3. **Given** 이미지 생성이 완료되었을 때, **When** 사용자가 다운로드 버튼을 클릭하면, **Then** 이미지 파일이 사용자 기기에 저장된다
4. **Given** 사용자가 고급 설정을 원할 때, **When** 파라미터 패널을 열면, **Then** 비율, 시드, 스텝, 가이던스 스케일 등을 조절할 수 있다

---

### User Story 2 - 이미지 기반 변형 생성 (Priority: P2)

사용자가 기존 이미지를 업로드하고 프롬프트를 입력하여 유사한 구도나 스타일을 유지하면서 변형된 이미지를 생성한다.

**Why this priority**: Text-to-Image 다음으로 사용 빈도가 높으며, 기존 이미지를 참조하여 원하는 방향으로 수정할 수 있어 더 정밀한 결과물을 얻을 수 있음

**Independent Test**: 이미지를 업로드하고 프롬프트를 입력한 후 생성하면 원본의 구도나 특성을 유지하면서 변형된 이미지가 생성됨

**Acceptance Scenarios**:

1. **Given** 사용자가 Image-to-Image 모드에 있을 때, **When** 이미지를 업로드하고 프롬프트를 입력하여 생성하면, **Then** 원본 이미지의 구도를 참조한 새 이미지가 생성된다
2. **Given** 이미지가 업로드되었을 때, **When** 변형 강도(strength)를 조절하면, **Then** 강도에 따라 원본과의 유사도가 달라진 결과가 생성된다
3. **Given** 업로드된 이미지가 지원 비율과 다를 때, **When** 사용자가 리사이즈 옵션을 선택하면, **Then** 중앙 크롭/패딩/원본 유지 중 선택한 방식으로 처리된다

---

### User Story 3 - 마스크 기반 이미지 편집 (Priority: P3)

사용자가 이미지의 특정 영역을 마스크로 지정하여 해당 부분만 수정하거나 새로운 요소를 추가한다 (인페인팅).

**Why this priority**: 고급 기능이지만 전문 사용자에게 핵심적인 기능. 배경 교체, 오브젝트 제거/추가 등 정밀한 편집이 가능해짐

**Independent Test**: 이미지를 업로드하고 캔버스에서 마스크를 그린 후 프롬프트와 함께 생성하면 마스크 영역만 변경된 이미지가 생성됨

**Acceptance Scenarios**:

1. **Given** 사용자가 편집 모드에서 이미지를 업로드했을 때, **When** 캔버스에서 브러시로 마스크를 그리면, **Then** 마스크 영역이 시각적으로 표시된다
2. **Given** 마스크가 지정되었을 때, **When** "오브젝트 제거" 프리셋을 선택하고 생성하면, **Then** 마스크 영역의 오브젝트가 자연스럽게 제거된 이미지가 생성된다
3. **Given** 마스크가 지정되었을 때, **When** 프롬프트에 추가할 오브젝트를 입력하고 생성하면, **Then** 마스크 영역에 새 오브젝트가 추가된 이미지가 생성된다
4. **Given** "배경 교체" 프리셋을 선택했을 때, **When** 새 배경에 대한 프롬프트를 입력하고 생성하면, **Then** 전경은 유지하고 배경만 변경된 이미지가 생성된다

---

### User Story 4 - 생성 히스토리 및 갤러리 (Priority: P4)

사용자가 이전에 생성한 모든 이미지를 갤러리에서 확인하고, 파라미터를 재사용하여 유사한 이미지를 다시 생성할 수 있다.

**Why this priority**: 사용 편의성을 높이고 반복 작업을 줄여주는 기능. 핵심 생성 기능이 완성된 후 구현해도 됨

**Independent Test**: 갤러리 페이지에서 이전 생성 이미지 목록을 보고, 특정 이미지의 파라미터를 복제하여 재생성할 수 있음

**Acceptance Scenarios**:

1. **Given** 사용자가 갤러리 페이지에 접근했을 때, **When** 페이지가 로드되면, **Then** 최신순으로 정렬된 생성 이미지 목록이 표시된다
2. **Given** 갤러리에서 이미지를 선택했을 때, **When** 상세 보기를 클릭하면, **Then** 해당 이미지의 프롬프트, 파라미터, 시드, 모델 정보가 표시된다
3. **Given** 이미지 상세 보기에서, **When** "재실행" 버튼을 클릭하면, **Then** 동일한 파라미터로 새 이미지 생성이 시작된다
4. **Given** 이미지 상세 보기에서, **When** "파라미터 복제" 버튼을 클릭하면, **Then** 생성 페이지로 이동하며 파라미터가 자동 입력된다

---

### User Story 5 - 관리자 모니터링 (Priority: P5)

관리자가 시스템 상태, 사용량, 오류를 모니터링하고 정책을 설정할 수 있다.

**Why this priority**: 운영에 필요하지만 사용자 기능이 먼저 완성되어야 의미가 있음. MVP 이후 단계에서 구현 가능

**Independent Test**: 관리자 계정으로 로그인하여 대시보드에서 요청량, 오류율, 응답시간을 확인할 수 있음

**Acceptance Scenarios**:

1. **Given** 관리자가 관리 페이지에 접근했을 때, **When** 대시보드가 로드되면, **Then** 요청량, 오류율, 응답시간 통계가 표시된다
2. **Given** 관리자가 정책 설정 페이지에서, **When** 금칙어를 등록하면, **Then** 해당 단어가 포함된 프롬프트는 차단된다
3. **Given** 관리자가 로그 페이지에서, **When** 특정 기간의 로그를 조회하면, **Then** 누가, 언제, 어떤 입력으로 생성했는지 확인할 수 있다

---

### Edge Cases

- 매우 긴 프롬프트가 입력되었을 때 어떻게 처리하는가? (최대 길이 제한 및 안내 메시지)
- 지원되지 않는 이미지 형식이 업로드되었을 때? (허용 형식 안내 및 변환 또는 거부)
- 모델 서버가 응답하지 않거나 타임아웃될 때? (재시도 옵션 및 오류 메시지)
- 동시에 여러 작업을 요청했을 때? (큐 대기 상태 표시 및 순차 처리)
- 유해 콘텐츠가 포함된 프롬프트가 입력되었을 때? (필터링 및 경고 메시지)
- 업로드 이미지가 너무 크거나 해상도가 높을 때? (크기 제한 및 자동 리사이즈)
- 생성 중 브라우저를 닫거나 새로고침했을 때? (작업 상태 유지 및 복구)
- 마스크가 이미지 전체를 덮었을 때? (경고 및 Text-to-Image로 전환 제안)

## Requirements *(mandatory)*

### Functional Requirements

#### 공통 요구사항

- **FR-001**: System MUST 모든 이미지 생성 요청을 비동기 작업(Job)으로 처리한다
- **FR-002**: System MUST 각 작업의 상태(대기/진행/완료/실패)를 사용자에게 실시간으로 표시한다
- **FR-003**: System MUST 완료된 결과를 원본/파생 이미지 및 메타데이터와 함께 저장한다
- **FR-004**: System MUST 동일한 시드와 파라미터로 재현 가능한 결과를 생성한다
- **FR-005**: Users MUST be able to 생성된 이미지를 다운로드할 수 있다
- **FR-006**: System MUST 사용자당 일일 이미지 생성을 3회로 제한한다
- **FR-007**: System MUST 남은 일일 생성 횟수를 사용자에게 표시한다

#### 인증

- **FR-AUTH-001**: System MUST 이메일/비밀번호 기반 회원가입을 제공한다
- **FR-AUTH-002**: System MUST 이메일/비밀번호 기반 로그인을 제공한다
- **FR-AUTH-003**: System MUST 인증된 사용자만 이미지 생성 기능에 접근할 수 있도록 한다
- **FR-AUTH-004**: Users MUST be able to 로그아웃할 수 있다

#### Text-to-Image

- **FR-T2I-001**: System MUST 프롬프트(필수)와 네거티브 프롬프트(선택)를 입력받는다
- **FR-T2I-002**: System MUST 이미지 비율 선택을 제공한다 (1:1, 4:3, 3:4, 16:9, 9:16)
- **FR-T2I-003**: System MUST 해상도 프리셋을 제공한다
- **FR-T2I-004**: Users MUST be able to 시드(자동/수동), 스텝, 가이던스 스케일을 조절할 수 있다
- **FR-T2I-005**: System MUST 기본값이 설정된 간단 모드를 기본으로 제공한다

#### Image-to-Image

- **FR-I2I-001**: System MUST 입력 이미지 업로드(필수)와 프롬프트(필수)를 요구한다
- **FR-I2I-002**: Users MUST be able to 변형 강도(denoise/strength)를 조절할 수 있다
- **FR-I2I-003**: System MUST 구도 유지 옵션을 제공한다
- **FR-I2I-004**: System MUST 리사이즈/크롭 정책을 제공한다 (중앙 크롭/패딩/원본 유지)

#### 이미지 합성(인페인팅/아웃페인팅)

- **FR-EDIT-001**: System MUST 입력 이미지와 마스크 업로드를 지원한다
- **FR-EDIT-002**: System MUST 캔버스에서 마스크를 직접 그릴 수 있는 도구를 제공한다
- **FR-EDIT-003**: System MUST 마스크 영역만 수정하는 인페인팅을 지원한다
- **FR-EDIT-004**: System MUST 간단 프리셋을 제공한다 (배경 제거/교체, 오브젝트 제거, 오브젝트 추가)
- **FR-EDIT-005**: System SHOULD 아웃페인팅(이미지 확장)을 지원한다 (모델 지원 시)

#### 갤러리/히스토리

- **FR-GAL-001**: System MUST 사용자별 생성 결과 목록을 최신순으로 표시한다
- **FR-GAL-002**: System MUST 각 이미지의 상세 정보(입력값/파라미터/시드/모델)를 표시한다
- **FR-GAL-003**: Users MUST be able to 이전 작업을 재실행하거나 파라미터를 복제할 수 있다

#### 안전/정책

- **FR-SAFE-001**: System MUST 프롬프트 정책 필터(금칙어/카테고리 기반)를 적용한다
- **FR-SAFE-002**: System MUST 이미지 업로드 시 파일 타입과 크기를 검증한다
- **FR-SAFE-003**: System MUST 모든 생성 요청을 로그로 기록한다 (누가, 언제, 어떤 입력)
- **FR-SAFE-004**: System MUST 생성된 이미지를 2일(48시간) 후 자동 삭제한다
- **FR-SAFE-005**: System MUST 이미지 삭제 전 사용자에게 다운로드 안내를 표시한다

### Key Entities

- **User**: 서비스 사용자. 이미지 생성 요청을 하고 결과를 확인/다운로드함. 자신의 생성 히스토리를 조회할 수 있음
- **Job**: 이미지 생성 작업 단위. 상태(대기/진행/완료/실패), 생성 시간, 완료 시간, 입력 파라미터를 포함
- **GeneratedImage**: 생성된 이미지. 파일 경로, 생성 시간, 관련 Job, 메타데이터(시드, 파라미터)를 포함
- **Prompt**: 사용자 입력 텍스트. 메인 프롬프트와 네거티브 프롬프트로 구분
- **Mask**: 인페인팅/아웃페인팅용 마스크 데이터. 편집 영역을 정의
- **Preset**: 미리 정의된 파라미터 조합. 비율, 해상도, 스텝 등의 기본값 세트

## Success Criteria *(mandatory)*

### Measurable Outcomes

- **SC-001**: 사용자가 프롬프트 입력부터 이미지 생성 완료까지 60초 이내에 결과를 확인할 수 있다 (표준 해상도 기준)
- **SC-002**: 90% 이상의 생성 요청이 성공적으로 완료된다
- **SC-003**: 사용자가 3번의 클릭 이내에 이미지를 생성할 수 있다 (간단 모드)
- **SC-004**: 갤러리에서 이전 작업의 파라미터를 복제하여 재생성하는데 10초 이내가 소요된다
- **SC-005**: 마스크 도구를 사용하여 편집 영역을 지정하는데 30초 이내가 소요된다
- **SC-006**: 시스템이 100명의 동시 사용자를 지원한다
- **SC-007**: 유해 콘텐츠 필터가 95% 이상의 정확도로 금칙어를 감지한다
- **SC-008**: 작업 실패 시 명확한 오류 메시지가 2초 이내에 표시된다

## Assumptions

- 사용자 인증은 이메일/비밀번호 기반 회원가입 및 로그인으로 구현
- 이미지 저장소는 로컬 파일 시스템 사용 (클라우드 스토리지는 향후 확장)
- 모델 API는 Hugging Face Inference API를 기본으로 사용
- 동시 사용자 100명 규모의 소규모 서비스로 시작
- 모바일 최적화는 초기 버전에서 제외 (데스크톱 브라우저 우선)
- 결제/구독 시스템은 초기 버전에서 제외
- 아웃페인팅 기능은 모델 지원 여부에 따라 구현 범위 조정

## Out of Scope

- 모바일 앱 개발
- 결제 및 구독 시스템
- 다국어 지원 (한국어/영어 외)
- 실시간 협업 기능
- 비디오 생성
- 3D 모델 생성
- 자체 AI 모델 학습/파인튜닝
